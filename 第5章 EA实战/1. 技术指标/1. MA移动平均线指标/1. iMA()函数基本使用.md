# 1. `iMA()`函数基本使用

- `iMA(string symbol, int timeframe, int period, int ma_shift, int ma_method, int applied_price, int shift)`: 计算指定货币对和时间框架的移动平均值
  - `symbol`: 货币对名称.`NULL`表示当前图表货币对
  - `timeframe`: 时间框架.类似于Prometheus中的`interval`的概念.`0`表示当前图表时间框架
    - 该参数可以填写`PERIOD_M1`等常量
  - `period`: 移动平均线周期.类似于"多少个`interval`的概念
    - 例: `timeframe = PERIOD_M1`,`period = 14`,`ma_method = SMA`,`applied_price = `表示计算1分钟图上14周期的简单移动平均线(说白了就是取14根K线)
  - `ma_shift`: 移动平均线偏移量
    - 例: `ma_shift = 0`表示不偏移;`ma_shift = 1`表示向右(未来方向)偏移1个周期;`ma_shift = -1`表示向左(历史方向)偏移1个周期
  - `ma_method`: 移动平均线方法
    - `MODE_SMA`: 简单移动平均线(Simple Moving Average)
    - `MODE_EMA`: 指数移动平均线(Exponential Moving Average)
    - `MODE_SMMA`: 平滑移动平均线(Smoothed Moving Average)
    - `MODE_LWMA`: 线性加权移动平均线(Linear Weighted Moving Average)
  - `applied_price`: 应用价格类型
    - `PRICE_CLOSE`: 收盘价
    - `PRICE_OPEN`: 开盘价
    - `PRICE_HIGH`: 最高价
    - `PRICE_LOW`: 最低价
    - `PRICE_MEDIAN`: 中间价 ( (最高价 + 最低价) / 2 )
    - `PRICE_TYPICAL`: 典型价 ( (最高价 + 最低价 + 收盘价) / 3 )
    - `PRICE_WEIGHTED`: 加权价 ( (最高价 + 最低价 + 2 * 收盘价) / 4 )
    - `shift`: 数据点索引
      - `shift = 0`: 获取最新K线的移动平均值
      - `shift = 1`: 获取前一根K线的移动平均值
      - 例:
        - `iMA(NULL, 0, 14, 0, MODE_SMA, PRICE_CLOSE, 0)`: 获取当前K线的14周期简单移动平均线值
        - `iMA(NULL, 0, 14, 0, MODE_SMA, PRICE_CLOSE, 1)`: 获取前一根K线的14周期简单移动平均线值

```mq4
void OnTimer()
  {
//---
   double sma5 = iMA(Symbol(), PERIOD_M1, 5, 0, MODE_SMA, PRICE_CLOSE, 0);
   for(int i = 0; i < 5; i++) {
      double closeI = iClose(Symbol(), PERIOD_M1, i);
      Print("Close " , i, " = ", closeI);
   }
   Print("5分钟平均收盘价为: ", NormalizeDouble(sma5, Digits));
  }
```


