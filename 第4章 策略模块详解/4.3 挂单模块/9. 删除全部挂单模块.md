# 9. 删除全部挂单模块

在有些策略中,会同时挂多个种类的挂单,或不同货币对的挂单.若满足一定的条件,需要将挂单都删除.这种场景下就需要一个能够删除所有种类挂单的模块.

```mq4
// currencyPair 货币对
string currencyPair;

// MAGIC 魔术号,和EA是1对1关系.本质是一个用户自定义的订单标识.用于在同一个账户中,标识不同EA下的订单
int MAGIC = 106;

// alertFlag 标识是否开启警告的标记位
bool alertFlag = false;

void closePendingOrder() {
   // 订单号
   int ticket = 0;
  
   // 订单类型
   int orderType;
   
   // 用于遍历订单的索引
   int orderIndex;
   
   // 用于标识关闭挂单是否成功的标量
   bool closeResult = false;
   
   for (orderIndex = OrdersTotal() - 1; orderIndex >= 0; orderIndex--) {
      bool selectResult = OrderSelect(orderIndex, SELECT_BY_POS);
      if (!selectResult) {
         continue;
      }
      
      if (OrderSymbol() != currencyPair) {
         continue;
      }
      
      if (OrderMagicNumber() != MAGIC) {
         continue;
      }
      
      orderType = OrderType();
      
      if (orderType != OP_BUYSTOP) {
         continue;
      }
      
      if (orderType != OP_BUYLIMIT) {
         continue;
      }
      
      if (orderType != OP_SELLSTOP) {
         continue;
      }
      
      if (orderType != OP_SELLLIMIT) {
         continue;
      }
      
      ticket = OrderTicket();
      closeResult = OrderDelete(ticket);
      
      if(!alertFlag) {
         continue;
      }
      
      if(!closeResult) {
         Alert("删除 ", orderType, " 类型挂单失败: ", GetLastError());
         continue;
      }
      
      Alert("成功删除 ", orderType, " 类型挂单,订单号为: ", ticket);
   }
}
```
